<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Configure Identity Proof</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 2rem auto; }
    label { display: block; margin: 1rem 0; }
    .inline { display: inline-block; width: 48%; }
    button { padding: 0.5rem 1rem; font-size: 1rem; }
  </style>
</head>
<body>
  <h1>Choose what to prove</h1>
  <form id="cfg">
    <div class="inline">
      <label>First name:
        <input type="text" name="first_name_val" placeholder="e.g. Alice">
      </label>
      <label><input type="checkbox" name="first_name"> Include first name in proof</label>
    </div>
    <div class="inline">
      <label>Last name:
        <input type="text" name="last_name_val" placeholder="e.g. Smith">
      </label>
      <label><input type="checkbox" name="last_name"> Include last name in proof</label>
    </div>

    <label>License number:
      <input type="number" name="license" min="1" placeholder="Optional">
    </label>

    <label>Born after:
      <input type="date" name="dob_after">
    </label>
    <label>Born before:
      <input type="date" name="dob_before">
    </label>

    <button type="button" id="launch">Validate Identity</button>
  </form>

  <script>
    document.getElementById('launch').addEventListener('click', () => {
      const form = new FormData(document.getElementById('cfg'));
      const params = [];
      // origin is our /verify endpoint
      const origin = encodeURIComponent(window.location.origin + '/verify');

      // first name
      if (form.get('first_name')) {
        const v = form.get('first_name_val')?.trim() || '';
        if (!v) { return alert('Please enter a first name.'); }
        params.push(`first_name=${encodeURIComponent(v)}`);
      }
      // last name
      if (form.get('last_name')) {
        const v = form.get('last_name_val')?.trim() || '';
        if (!v) { return alert('Please enter a last name.'); }
        params.push(`last_name=${encodeURIComponent(v)}`);
      }
      // license
      if (form.get('license')) {
        params.push(`license=${encodeURIComponent(form.get('license'))}`);
      }
      // dob_after / dob_before → days-since-CE
      ['dob_after','dob_before'].forEach(key => {
        const val = form.get(key);
        if (val) {
          const days = Math.floor(new Date(val).getTime() / 86400000) + 719163;
          params.push(`${key}=${days}`);
        }
      });

      const uri = `identity://verify?origin=${origin}&${params.join('&')}`;
      // navigate—will fire your CLI and then redirect back to /verify
      window.location.href = uri;
    });
  </script>
</body>
</html>
